import { BuildManifest, BuildTarget } from "@trigger.dev/core/v3";
import { BuildContext, BuildExtension } from "@trigger.dev/core/v3/build";
export type PrismaLegacyModeExtensionOptions = {
    /**
     * Legacy mode configuration for Prisma 5.x/6.x with the `prisma-client-js` provider.
     *
     * **Use this mode when:**
     * - Using Prisma 5.x or 6.x with `prisma-client-js` provider
     * - You want automatic `prisma generate` during deployment
     * - You need migration support
     *
     * **Key features:**
     * - Automatic client generation
     * - Multi-file schema support (Prisma 6.7+)
     * - Config file support (`prisma.config.ts`)
     * - TypedSQL support
     * - Automatic version detection
     */
    mode: "legacy";
    /**
     * Path to your Prisma schema file or directory.
     *
     * **Examples:**
     * - Single file: `"./prisma/schema.prisma"`
     * - Multi-file (Prisma 6.7+): `"./prisma"`
     *
     * **Note:** Either `schema` or `configFile` must be specified, but not both.
     */
    schema?: string;
    /**
     * Path to your Prisma config file (`prisma.config.ts`).
     *
     * Uses `@prisma/config` to automatically extract schema and migrations paths.
     * Requires Prisma 6+ with config file support.
     *
     * **Example:**
     * ```ts
     * prismaExtension({
     *   mode: "legacy",
     *   configFile: "./prisma.config.ts",
     *   migrate: true,
     * });
     * ```
     *
     * **Note:** Either `schema` or `configFile` must be specified, but not both.
     */
    configFile?: string;
    /**
     * Enable automatic database migrations during deployment.
     *
     * Runs `prisma migrate deploy` before generating the client.
     * Requires `directUrlEnvVarName` to be set.
     */
    migrate?: boolean;
    /**
     * Override the auto-detected Prisma version.
     *
     * **Auto-detection:** Checks externals, then `@prisma/client` in node_modules, then `prisma` package.
     */
    version?: string;
    /**
     * Enable TypedSQL support. Adds `--sql` flag to `prisma generate`.
     *
     * Requires Prisma 5.19+ and `previewFeatures = ["typedSql"]` in your schema.
     */
    typedSql?: boolean;
    /**
     * Specify which generator to use when you have multiple generators.
     *
     * Adds `--generator=<name>` to only generate the specified generator.
     * Useful for skipping extra generators like `typegraphql-prisma`.
     */
    clientGenerator?: string;
    /**
     * Environment variable name for the direct (unpooled) database connection.
     *
     * Required for migrations. Common values: `"DATABASE_URL_UNPOOLED"`, `"DIRECT_URL"`.
     */
    directUrlEnvVarName?: string;
};
export type PrismaEngineOnlyModeExtensionOptions = {
    /**
     * Engine-only mode for custom Prisma client output paths.
     *
     * **Use this mode when:**
     * - You're using a custom output path for Prisma Client
     * - You want to control when `prisma generate` runs
     * - You run `prisma generate` in your build pipeline
     *
     * **What it does:**
     * - Installs engine binaries only (no client generation)
     * - Sets `PRISMA_QUERY_ENGINE_LIBRARY` and `PRISMA_QUERY_ENGINE_SCHEMA_ENGINE` env vars
     * - Auto-detects version from filesystem
     *
     * **You must:** Run `prisma generate` yourself and include correct `binaryTargets` in your schema.
     */
    mode: "engine-only";
    /**
     * Prisma version to use. Auto-detected from `@prisma/client` or `prisma` package if omitted.
     *
     * **Recommended:** Specify explicitly for reproducible builds.
     */
    version?: string;
    /**
     * Binary target platform for Prisma engines.
     *
     * **Default:** `"debian-openssl-3.0.x"` (for Trigger.dev Cloud)
     * **Local Docker on ARM:** `"linux-arm64-openssl-3.0.x"`
     */
    binaryTarget?: string;
    /**
     * Suppress progress messages during the build.
     */
    silent?: boolean;
};
export type PrismaEngineModernModeExtensionOptions = {
    /**
     * Modern mode for Prisma 6.16+ (with `prisma-client` provider) and Prisma 7.
     *
     * **Use this mode when:**
     * - Using Prisma 6.16+ with `provider = "prisma-client"` and `engineType = "client"`
     * - Using Prisma 7 beta or later
     * - Using database adapters (e.g., `@prisma/adapter-pg`)
     *
     * **What it does:**
     * - Marks `@prisma/client` as external (zero config)
     * - Works with TypeScript-only client (no Rust binaries)
     *
     * **You must:** Run `prisma generate` yourself and install database adapters.
     */
    mode: "modern";
};
export type PrismaExtensionOptions = PrismaLegacyModeExtensionOptions | PrismaEngineOnlyModeExtensionOptions | PrismaEngineModernModeExtensionOptions;
/**
 * Prisma build extension for Trigger.dev deployments.
 *
 * **Three modes available:**
 * - `"legacy"` - Prisma 5.x/6.x with `prisma-client-js`, automatic generation
 * - `"engine-only"` - Custom output paths, manual generation control
 * - `"modern"` - Prisma 6.16+/7.x with `prisma-client` provider
 *
 * @example Legacy mode (most common)
 * ```ts
 * prismaExtension({
 *   mode: "legacy",
 *   schema: "prisma/schema.prisma",
 *   migrate: true,
 *   typedSql: true,
 * });
 * ```
 *
 * @example Engine-only mode (custom output)
 * ```ts
 * prismaExtension({
 *   mode: "engine-only",
 *   version: "6.19.0",
 * });
 * ```
 *
 * @example Modern mode (Prisma 7)
 * ```ts
 * prismaExtension({
 *   mode: "modern",
 * });
 * ```
 */
export declare function prismaExtension(options: PrismaExtensionOptions): BuildExtension;
export declare class PrismaLegacyModeExtension implements BuildExtension {
    private options;
    moduleExternals: string[];
    readonly name = "PrismaExtension";
    private _resolvedSchemaPath?;
    private _loadedConfig?;
    constructor(options: PrismaLegacyModeExtensionOptions);
    externalsForTarget(target: BuildTarget): string[];
    onBuildStart(context: BuildContext): Promise<void>;
    onBuildComplete(context: BuildContext, manifest: BuildManifest): Promise<void>;
}
export declare class PrismaEngineOnlyModeExtension implements BuildExtension {
    private options;
    readonly name = "PrismaEngineOnlyModeExtension";
    private _binaryTarget;
    constructor(options: PrismaEngineOnlyModeExtensionOptions);
    onBuildComplete(context: BuildContext, manifest: BuildManifest): Promise<void>;
}
export declare class PrismaEngineModernModeExtension implements BuildExtension {
    private options;
    moduleExternals: string[];
    readonly name = "PrismaEngineModernModeExtension";
    constructor(options: PrismaEngineModernModeExtensionOptions);
    externalsForTarget(target: BuildTarget): string[];
}
