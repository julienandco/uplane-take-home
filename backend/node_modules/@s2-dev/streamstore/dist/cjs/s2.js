"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.S2 = void 0;
const accessTokens_js_1 = require("./accessTokens.js");
const basin_js_1 = require("./basin.js");
const basins_js_1 = require("./basins.js");
const index_js_1 = require("./generated/client/index.js");
const Redacted = require("./lib/redacted.js");
const metrics_js_1 = require("./metrics.js");
const defaultBaseUrl = "https://aws.s2.dev/v1";
const defaultMakeBasinBaseUrl = (basin) => `https://${basin}.b.aws.s2.dev/v1`;
/**
 * Top-level S2 SDK client.
 *
 * - Authenticates with an access token and exposes account-scoped helpers for basins, streams, access tokens and metrics.
 */
class S2 {
    accessToken;
    client;
    makeBasinBaseUrl;
    includeBasinHeader;
    /**
     * Account-scoped basin management operations.
     *
     * - List, create, delete and reconfigure basins.
     */
    basins;
    /** Manage access tokens for the account (list, issue, revoke). */
    accessTokens;
    /** Account, basin and stream level metrics. */
    metrics;
    /**
     * Create a new S2 client.
     *
     * @param options Access token configuration.
     */
    constructor(options) {
        this.accessToken = Redacted.make(options.accessToken);
        this.client = (0, index_js_1.createClient)((0, index_js_1.createConfig)({
            baseUrl: options.baseUrl ?? defaultBaseUrl,
            auth: () => Redacted.value(this.accessToken),
        }));
        this.basins = new basins_js_1.S2Basins(this.client);
        this.accessTokens = new accessTokens_js_1.S2AccessTokens(this.client);
        this.metrics = new metrics_js_1.S2Metrics(this.client);
        this.makeBasinBaseUrl = options.makeBasinBaseUrl ?? defaultMakeBasinBaseUrl;
        this.includeBasinHeader = !!options.makeBasinBaseUrl;
    }
    /**
     * Create a basin-scoped client bound to a specific basin name.
     *
     * @param name Basin name.
     */
    basin(name) {
        return new basin_js_1.S2Basin(name, {
            accessToken: this.accessToken,
            baseUrl: this.makeBasinBaseUrl(name),
            includeBasinHeader: this.includeBasinHeader,
        });
    }
}
exports.S2 = S2;
//# sourceMappingURL=s2.js.map