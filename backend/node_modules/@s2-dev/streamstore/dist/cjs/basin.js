"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.S2Basin = void 0;
const index_js_1 = require("./generated/client/index.js");
const Redacted = require("./lib/redacted.js");
const stream_js_1 = require("./stream.js");
const streams_js_1 = require("./streams.js");
class S2Basin {
    client;
    transportConfig;
    name;
    streams;
    /**
     * Create a basin-scoped client that talks to `https://{basin}.b.aws.s2.dev/v1`.
     *
     * Use this to work with streams inside a single basin.
     * @param name Basin name
     * @param accessToken Redacted access token from the parent `S2` client
     * @param baseUrl Base URL for the basin (e.g. `https://my-basin.b.aws.s2.dev/v1`)
     * @param includeBasinHeader Include the `S2-Basin` header with the request
     */
    constructor(name, options) {
        this.name = name;
        this.transportConfig = {
            baseUrl: options.baseUrl,
            accessToken: options.accessToken,
        };
        this.client = (0, index_js_1.createClient)((0, index_js_1.createConfig)({
            baseUrl: options.baseUrl,
            auth: () => Redacted.value(this.transportConfig.accessToken),
            headers: options.includeBasinHeader ? { "s2-basin": name } : {},
        }));
        this.streams = new streams_js_1.S2Streams(this.client);
    }
    /**
     * Create a stream-scoped helper bound to `this` basin.
     * @param name Stream name
     */
    stream(name, options) {
        return new stream_js_1.S2Stream(name, this.client, {
            ...this.transportConfig,
            forceTransport: options?.forceTransport,
        });
    }
}
exports.S2Basin = S2Basin;
//# sourceMappingURL=basin.js.map